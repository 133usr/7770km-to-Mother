<!DOCTYPE html>
<html>
  <head>
    <meta charset=UTF-8 />
    <!-- <link rel="stylesheet" type="text/css" href="score_board_styles.css" /> -->
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="https://fonts.googleapis.com/css?family=Raleway&display=swap" rel="stylesheet"> 
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lil-gui@0.18.1/dist/lil-gui.min.css">
<link rel="stylesheet" href="./Table6_files/bootstrap.min.css">

<link rel="stylesheet" href="./Table6_files/style(1).css">
<link rel="stylesheet" href="./stars_styles.css">

  </head>
  <body>
    <!-- <div class="text-box">
      <div class="heading">To infinity and Beyond</div>
      <div class="button-wrapper">
          <div class="button">Learn More</div>
          <div class="button">Contact Us</div>
      </div>
    </div> -->
    
    <div id="scoreButton">
      <div><br></div>
      <button class="btn btn-primary custom-btn" onclick="window.history.back();">7770km to Mother</button>

    </div>

    <div class="content" >
        <div class="container">
        <h2 class="mb-5">Score Board</h2>
        <div class="table-responsive" >
        <table id="score-table" class="table table-striped custom-table" >
        <thead>
        <tr class="headRow">
        
        <th class="sticky-col" scope="col">नाम<br> <br><br></th>
        <th scope="col">टोटल</th>
        <th scope="col">सरल प्रचार</th>
        <th scope="col">फल</th>
        <th scope="col">अपॉइनमेंट<br>विजिटिंग</th>
        <th scope="col">साइन</th>
        <th scope="col">इवैल्यूएशन</th>
        <th scope="col">EDULMS</th>
        <th scope="col">मीटिंग</th>
        <th scope="col">Pray<br>Daily</th>
        <th scope="col">बाइबिल<br>उपदेश</th>
        
        </tr>
        </thead>
        <tbody>
        <tr scope="row">
        </tbody>
        </table>
        </div>
        </div>
        </div>
        <div id="stars"></div>
        <div id="stars2"></div>
        <div id="stars3"></div>
<script>








/**************************************************************
 *                                                           *
 *                   MAIN FUNCTION                            *
 *                                                           *
 **************************************************************/
/**************************************************************
 *                                                           *
 *      tempsheetObject can be available throught sheet       *
 *          all you need to do is to iterate it 
 *                                                            *
 **************************************************************/


 async function main() {
      
      let allData = await fetchData();
            
      allData = allData.replace(/[""]+/g,'"'); //dont' know why data has extra ""  so remove them
      allData = allData.replace('"[{','[{'); //dont' know why data has extra ["  so remove them
      allData = allData.replace('}]"','}]');     
      // console.log(allData);  
      var sheet_arrayObject = JSON.parse(allData);  
      var participants = Object.keys(sheet_arrayObject).length;
     
                             
                                
                $(function() {
                    $.each(sheet_arrayObject, function(i, item) {
                      if (item.Total==0)
                      { return;} //show only those who are participating
                           var total = (item.Total).toFixed(2);
                           var fruit = (item.totalFruits).toFixed(2);
                           var preach = (item.totalPreach).toFixed(2);
                           var sign = (item.totalSign).toFixed(2);        
                           var evaluat = (item.chap_complete).toFixed(2);
                           var edulms = (item.edulms).toFixed(2); 
                           var meeting = (item.meeting).toFixed(2); 
                           var pray_daily = (item.prayDaily).toFixed(2); 
                           var visit = (item.totalApp_visit).toFixed(2); 
                           var b_study = (item.b_study).toFixed(2); 

                        var $tr = $('<tr>').append(
                            $('<td class="sticky-col">').text(item.Participant),
                            $('<td>').text(total),
                            $('<td>').text(preach),
                            $('<td>').text(fruit),
                            $('<td>').text(visit),
                            $('<td>').text(sign),        
                            $('<td>').text(evaluat),
                            $('<td>').text(edulms),  
                            $('<td>').text(meeting), 
                            $('<td>').text(pray_daily),
                            $('<td>').text(b_study),   
                            ).appendTo('#score-table');
                        // console.log($tr.wrap('<p>').html());
                    });
                });
  
            }

            async function fetchData() {
  try {
    let url = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQ7Zx1Vnsdizp-ee3wroRGSME9hyu8bUvXWBQWiWf0zNWMJ7z5Wtj0lN52ibU_jg8PEsEWG53VFZ8ee/pub?gid=1246387545&single=true&output=csv&range=C3";
    const response = await fetch(url);
    
    if (!response.ok) {
      throw new Error('Network response was not ok.');
    }

    const text = await response.text();
    return text; // This is the fetched data
  } catch (error) {
    console.error('Error fetching data:', error);
    throw error;
  }
}
 

//CALL MAIN
main();


</script>








        <script src="./Table6_files/jquery-3.3.1.min.js.download"></script>
        <!-- <script src="./popper.min.js.download"></script> -->
        <script src="./Table6_files/bootstrap.min.js.download"></script>
        <!-- <script src="./Table6_files/main.js.download"></script> -->
   
    
<script src="./Table6_files/jquery-3.3.1.min.js.download"></script>
<!-- <script src="./Table6_files/popper.min.js.download"></script> -->
<!-- <script src="./Table6_files/bootstrap.min.js.download"></script> -->


  </body>
</html>
